<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>GlowBet - Premium Gaming</title>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  
  <style>
    /* CSS STYLES */
    :root {
      --primary-red: #e63946;
      --dark-red: #b92b36;
      --gold: #ffb703;
      --bg-dark: #1a1a1a;
      --bg-card: #2d2d2d;
      --text-light: #f1faee;
      --text-gray: #a8a8a8;
      --green: #2a9d8f;
      --nav-height: 65px;
      --violet: #8B5CF6;
      --dark-violet: #1a0b3d;
    }

    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      background: #000;
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }

    .app-container {
      width: 100%;
      max-width: 480px;
      background: #000;
      color: var(--text-light);
      position: relative;
      overflow-x: hidden;
      min-height: 100vh;
      padding-bottom: 80px;
      box-shadow: 0 0 20px rgba(0,0,0,0.8);
    }

    /* SHAKE ANIMATION */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
      20%, 40%, 60%, 80% { transform: translateX(10px); }
    }

    .shake {
      animation: shake 0.5s;
    }

    .hidden { display: none !important; }
    .text-red { color: var(--primary-red); }
    .text-gold { color: var(--gold); }
    .text-green { color: #10B981; }
    .text-gray { color: var(--text-gray); }
    .flex { display: flex; }
    .justify-between { justify-content: space-between; }
    .items-center { align-items: center; }
    .w-full { width: 100%; }

    /* Toast */
    .toast-container {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 9999;
      width: 90%;
      max-width: 400px;
    }
    .toast {
      background: rgba(0, 0, 0, 0.95);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      margin-bottom: 10px;
      animation: slideDown 0.3s ease-out;
      border-left: 4px solid var(--gold);
      font-size: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.5);
      backdrop-filter: blur(10px);
    }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Header */
    header {
      background: #000;
      padding: 15px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(0,0,0,0.8);
      border-bottom: 1px solid #333;
    }
    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .user-pill {
      background: rgba(255, 255, 255, 0.05);
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 5px;
      border: 1px solid #333;
    }
    .notif-badge {
      position: relative;
      cursor: pointer;
    }
    .badge-count {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--gold);
      color: #000;
      font-size: 10px;
      font-weight: bold;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Bottom Nav */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 480px;
      margin: 0 auto;
      background: #000;
      display: flex;
      justify-content: space-around;
      padding: 15px 0;
      border-top: 1px solid #333;
      box-shadow: 0 -5px 20px rgba(0,0,0,0.8);
      z-index: 1000;
      transition: transform 0.3s ease;
    }
    .bottom-nav.hide-nav {
      transform: translateY(100%);
    }
    .nav-item {
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      color: var(--text-gray);
      width: 20%;
    }
    .nav-item.active {
      color: var(--gold);
    }
    .nav-icon {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }

    /* Pages */
    .page-section {
      padding: 15px;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* HOME PAGE */
    .balance-card {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      position: relative;
      overflow: hidden;
      border: 1px solid #333;
      animation: slideUp 0.5s ease;
    }
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .balance-card::after {
      content: '';
      position: absolute;
      right: -20px;
      top: -20px;
      width: 100px;
      height: 100px;
      background: var(--gold);
      border-radius: 50%;
      opacity: 0.05;
    }
    .balance-label { font-size: 12px; color: var(--text-gray); }
    .balance-amount { 
      font-size: 24px; 
      font-weight: bold; 
      color: var(--gold);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .feature-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      cursor: pointer;
      animation: fadeInUp 0.5s ease;
    }
    @keyframes fadeInUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .icon-circle {
      width: 50px;
      height: 50px;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      color: var(--gold);
      transition: transform 0.3s, box-shadow 0.3s;
      border: 1px solid #333;
    }
    .feature-item:active .icon-circle { 
      transform: scale(0.9); 
      box-shadow: 0 0 20px rgba(255, 183, 3, 0.5);
    }
    .feature-text { font-size: 10px; color: var(--text-gray); text-align: center; }

    .banner-area {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      border: 1px solid #333;
      animation: slideUp 0.6s ease;
    }
    .join-btn {
      background: var(--gold);
      color: #000;
      border: none;
      padding: 5px 15px;
      border-radius: 20px;
      margin-top: 10px;
      font-size: 12px;
      cursor: pointer;
      font-weight: bold;
      transition: transform 0.2s;
    }
    .join-btn:active {
      transform: scale(0.95);
    }

    /* WALLET PAGE */
    .wallet-balance-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.5s ease;
    }
    .wallet-balance-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--gold);
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }
    .wallet-action-button {
      background: linear-gradient(135deg, #ffb703, #ffa200);
      color: #000;
      border: none;
      padding: 15px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
      width: 100%;
      box-shadow: 0 4px 15px rgba(255, 183, 3, 0.2);
    }
    .wallet-action-button:hover {
      background: linear-gradient(135deg, #ffa200, #ffb703);
      transform: translateY(-2px);
    }

    /* ACCOUNT PAGE */
    .profile-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.5s ease;
    }
    .profile-avatar {
      width: 100px;
      height: 100px;
      background: linear-gradient(135deg, #333, #000);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 3rem;
      color: var(--gold);
      border: 2px solid var(--gold);
      animation: rotate360 3s linear infinite;
    }
    @keyframes rotate360 {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* WINGO GAME PAGE */
    .wingo-page {
      display: none;
      background: #000;
      color: white;
      min-height: 100vh;
      padding: 20px;
      padding-bottom: 20px;
    }

    .wingo-header {
      text-align: center;
      margin-bottom: 20px;
      margin-top: 20px;
      animation: fadeIn 0.5s ease;
    }

    .wingo-title {
      font-size: 2rem;
      font-weight: bold;
      color: var(--gold);
      margin-bottom: 10px;
      animation: glow 2s ease-in-out infinite;
    }

    @keyframes glow {
      0%, 100% { text-shadow: 0 0 10px rgba(255, 183, 3, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 183, 3, 0.8), 0 0 30px rgba(255, 183, 3, 0.6); }
    }

    .balance-section {
      background: rgba(255, 255, 255, 0.03);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.6s ease;
    }

    .balance-amount {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--gold);
      animation: pulse 2s infinite;
    }

    .refresh-btn {
      background: var(--gold);
      color: #000;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      margin-left: 10px;
      font-weight: bold;
      transition: transform 0.2s;
    }
    .refresh-btn:active {
      transform: rotate(180deg);
    }

    .wallet-actions {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 10px;
      animation: slideUp 0.7s ease;
    }

    .wallet-btn {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px 20px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      flex: 1;
      font-weight: 600;
      color: var(--gold);
      border: 1px solid #333;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .wallet-btn:active {
      transform: scale(0.95);
      box-shadow: 0 0 20px rgba(255, 183, 3, 0.5);
    }

    .timer-section {
      background: rgba(255, 255, 255, 0.03);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.8s ease;
    }

    .timer {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--gold);
      animation: timerPulse 1s infinite;
    }

    @keyframes timerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .timer.urgent {
      color: #EF4444;
      animation: urgentBlink 0.5s infinite;
    }

    @keyframes urgentBlink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .betting-area {
      background: rgba(255, 255, 255, 0.03);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      position: relative;
      border: 1px solid #333;
      animation: slideUp 0.9s ease;
    }

    .color-options {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
      gap: 10px;
    }

    .color-option {
      padding: 15px 20px;
      border-radius: 20px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      flex: 1;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      border: none;
      animation: bounceIn 1s ease;
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); opacity: 1; }
    }

    .color-option:active {
      transform: scale(0.9);
    }

    .color-option.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    .red { background: linear-gradient(135deg, #EF4444, #DC2626); }
    .violet { background: linear-gradient(135deg, #8B5CF6, #7C3AED); }
    .green { background: linear-gradient(135deg, #10B981, #059669); }

    .number-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .number-cell {
      background: rgba(255, 255, 255, 0.05);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      font-size: 1.2rem;
      border: 1px solid #333;
      color: white;
      animation: fadeInUp 1.1s ease;
    }

    .number-cell:hover {
      transform: scale(1.05);
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 0 20px rgba(255, 183, 3, 0.5);
    }

    .number-cell:active {
      transform: scale(0.95);
    }

    .number-cell.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    .number-0 { background: linear-gradient(45deg, #EF4444, #8B5CF6); color: white; }
    .number-1, .number-3, .number-7, .number-9 { background: linear-gradient(135deg, #10B981, #059669); color: white; }
    .number-2, .number-4, .number-6, .number-8 { background: linear-gradient(135deg, #EF4444, #DC2626); color: white; }
    .number-5 { background: linear-gradient(45deg, #10B981, #8B5CF6); color: white; }

    .size-options {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      gap: 10px;
    }

    .size-option {
      background: rgba(255, 255, 255, 0.05);
      padding: 15px 20px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      flex: 1;
      color: white;
      font-size: 1.1rem;
      border: 1px solid #333;
      animation: fadeInUp 1.2s ease;
    }

    .size-option:active {
      transform: scale(0.95);
    }

    .size-option.small-btn {
      background: linear-gradient(135deg, #3B82F6, #2563EB);
    }

    .size-option.big-btn {
      background: linear-gradient(135deg, #F59E0B, #D97706);
    }

    .size-option.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    .history-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px 10px 0 0;
      overflow: hidden;
      border: 1px solid #333;
      margin-top: 20px;
    }

    .history-tab {
      flex: 1;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.05);
      transition: 0.3s;
      color: var(--text-gray);
      border-right: 1px solid #333;
    }

    .history-tab:last-child {
      border-right: none;
    }

    .history-tab.active {
      background: rgba(255, 183, 3, 0.2);
      color: var(--gold);
      font-weight: bold;
    }

    .history-content {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 0 0 10px 10px;
      padding: 15px;
      max-height: 500px;
      overflow-y: auto;
      border: 1px solid #333;
      border-top: none;
    }

    /* LOGIN & REGISTER PAGE */
    .auth-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: #000;
    }

    .auth-box {
      width: 100%;
      max-width: 450px;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px 30px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.5s ease;
    }

    .customer-support {
      position: fixed;
      bottom: 100px;
      right: 20px;
      background: linear-gradient(135deg, var(--gold), #ffa200);
      color: #000;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(255, 183, 3, 0.4);
      z-index: 10000;
      transition: all 0.3s;
      animation: float 3s ease-in-out infinite;
      font-weight: bold;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .back-button {
      position: absolute;
      top: 20px;
      left: 20px;
      background: var(--gold);
      color: #000;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 5px;
      box-shadow: 0 4px 15px rgba(255, 183, 3, 0.3);
      z-index: 100;
      font-weight: bold;
      transition: transform 0.2s;
    }
    .back-button:active {
      transform: scale(0.95);
    }

    .bet-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
      animation: fadeIn 0.3s;
    }

    .bet-popup-content {
      background: rgba(0, 0, 0, 0.95);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      color: white;
      animation: popupScale 0.3s ease-out;
    }

    @keyframes popupScale {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .bet-amount {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
    }

    .amount-btn {
      background: var(--gold);
      color: #000;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1.2rem;
      font-weight: bold;
      min-width: 50px;
      transition: transform 0.2s;
    }
    .amount-btn:active {
      transform: scale(0.9);
    }

    .amount-display {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--gold);
      min-width: 100px;
      padding: 10px;
      border: 2px solid var(--gold);
      border-radius: 8px;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.05);
      transition: all 0.3s;
    }
    .amount-display:hover {
      box-shadow: 0 0 20px rgba(255, 183, 3, 0.5);
    }

    .bet-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .bet-action-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: transform 0.2s;
    }
    .bet-action-btn:active {
      transform: scale(0.95);
    }

    .cancel-btn {
      background: #333;
      color: white;
    }

    .place-bet-btn {
      background: var(--gold);
      color: #000;
    }

    .win-popup, .lose-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 3000;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s;
    }

    .result-popup-content {
      background: rgba(0, 0, 0, 0.95);
      padding: 40px 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 350px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      color: white;
      animation: popupScale 0.3s ease-out;
    }

    .result-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    .win-icon { 
      color: #10B981; 
      animation: winGlow 1s infinite alternate;
    }

    @keyframes winGlow {
      from { text-shadow: 0 0 5px #10B981; }
      to { text-shadow: 0 0 20px #10B981, 0 0 30px #10B981; }
    }

    .lose-icon { 
      color: #EF4444; 
      animation: losePulse 1s infinite;
    }

    @keyframes losePulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .gift-code-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 3000;
      justify-content: center;
      align-items: center;
    }

    .gift-code-content {
      background: rgba(0, 0, 0, 0.95);
      padding: 30px;
      border-radius: 20px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      color: white;
      animation: popupScale 0.3s ease-out;
    }

    .deposit-page, .withdrawal-page {
      display: none;
      background: #000;
      min-height: 100vh;
      padding: 20px;
      padding-bottom: 80px;
      color: white;
    }

    .deposit-form-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid #333;
      animation: slideUp 0.5s ease;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-gray);
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #333;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.05);
      color: white;
    }

    .submit-btn {
      background: var(--gold);
      color: #000;
      border: none;
      padding: 15px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
      width: 100%;
      box-shadow: 0 4px 15px rgba(255, 183, 3, 0.2);
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .amount-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 20px 0;
    }

    .amount-option {
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid #333;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
      font-size: 16px;
      color: white;
    }

    .amount-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .amount-option.selected {
      background: var(--gold);
      color: #000;
      border-color: var(--gold);
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(255, 183, 3, 0.3);
    }

    .qr-code-section {
      text-align: center;
      margin: 30px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      border: 1px solid #333;
    }

    .qr-code-image {
      width: 280px;
      height: 280px;
      margin: 20px auto;
      border-radius: 10px;
      background: white;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    }

    .qr-code-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .guidelines-section {
      background: rgba(217, 119, 6, 0.1);
      border: 2px solid #D97706;
      border-radius: 10px;
      padding: 15px;
      margin-top: 20px;
    }

    .guidelines-list {
      list-style: none;
      padding-left: 0;
      color: #FBBF24;
      text-align: left;
    }

    .guidelines-list li {
      margin-bottom: 8px;
      font-size: 13px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .guidelines-list li:before {
      content: "‚Ä¢";
      color: var(--gold);
      font-weight: bold;
    }

    .insufficient-overlay {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(239, 68, 68, 0.95);
      color: white;
      padding: 30px 40px;
      border-radius: 15px;
      font-size: 1.5rem;
      font-weight: bold;
      z-index: 10000;
      box-shadow: 0 10px 40px rgba(239, 68, 68, 0.5);
      border: 3px solid white;
    }

    .admin-message-section {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 183, 3, 0.1);
      border-radius: 10px;
      border-left: 4px solid var(--gold);
    }

    .admin-message-section h4 {
      color: var(--gold);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .message-input {
      width: 100%;
      padding: 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid #333;
      border-radius: 8px;
      color: white;
      margin-bottom: 10px;
    }
    
    .history-page {
      display: none;
      background: #000;
      min-height: 100vh;
      padding: 20px;
      padding-bottom: 80px;
      color: white;
    }
    
    .history-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid #333;
    }
    
    .status-pending {
      background: rgba(245, 158, 11, 0.2);
      color: #F59E0B;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .status-completed {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .status-rejected {
      background: rgba(239, 68, 68, 0.2);
      color: #EF4444;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .deposit-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 3000;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s;
    }
    
    .deposit-popup-content {
      background: rgba(0, 0, 0, 0.95);
      padding: 30px;
      border-radius: 20px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      color: white;
      animation: popupScale 0.3s ease-out;
      text-align: center;
    }
    
    .deposit-popup-content h3 {
      color: var(--gold);
      margin-bottom: 15px;
    }
    
    .deposit-popup-content p {
      margin-bottom: 20px;
      color: #f1f5f9;
      font-size: 14px;
    }

    .toggle-auth {
      text-align: center;
      margin-top: 15px;
      font-size: 14px;
      color: var(--text-gray);
    }

    .toggle-auth span {
      color: var(--gold);
      cursor: pointer;
      font-weight: bold;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="app-container" id="appContainer">
    <div class="toast-container" id="toast-container"></div>
    <div class="insufficient-overlay" id="insufficientOverlay">üí∏ Insufficient Balance! üí∏</div>

    <!-- Win Popup -->
    <div class="win-popup" id="winPopup">
      <div class="result-popup-content">
        <div class="result-icon win-icon">üèÜ</div>
        <h3 style="color: #10B981; margin-bottom: 10px;">CONGRATULATIONS!</h3>
        <p id="winAmount" style="margin-bottom: 20px; font-size: 1.1rem;">You won ‚Çπ0</p>
        <button style="background: #10B981; color: #000; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold;" onclick="closeWinPopup()">AWESOME!</button>
      </div>
    </div>

    <!-- Lose Popup -->
    <div class="lose-popup" id="losePopup">
      <div class="result-popup-content">
        <div class="result-icon lose-icon">üí∏</div>
        <h3 style="color: #EF4444; margin-bottom: 10px;">BETTER LUCK NEXT TIME!</h3>
        <p id="loseAmount" style="margin-bottom: 20px; font-size: 1.1rem;">You lost ‚Çπ0</p>
        <button style="background: #EF4444; color: #000; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold;" onclick="closeLosePopup()">TRY AGAIN</button>
      </div>
    </div>

    <!-- Gift Code Modal -->
    <div class="gift-code-modal" id="giftCodeModal">
      <div class="gift-code-content">
        <h3 style="color: var(--gold); margin-bottom: 20px; text-align: center;">üéÅ REDEEM GIFT CODE</h3>
        <div class="form-group">
          <label class="form-label">Enter Gift Code</label>
          <input type="text" class="form-input" id="giftCodeInput" placeholder="Enter gift code">
        </div>
        <button class="submit-btn" onclick="redeemGiftCode()">üéÅ REDEEM NOW</button>
        <button style="background: #333; color: white; border: none; padding: 15px; border-radius: 10px; font-size: 16px; cursor: pointer; width: 100%; margin-top: 10px;" onclick="closeGiftCodeModal()">CANCEL</button>
      </div>
    </div>

    <!-- Deposit Popup -->
    <div class="deposit-popup" id="depositPopup">
      <div class="deposit-popup-content">
        <h3 style="color: var(--gold); margin-bottom: 15px;">‚úÖ Deposit Request Submitted!</h3>
        <p style="margin-bottom: 15px; color: #f1f5f9;">Your deposit request has been received. Your amount will be credited immediately.</p>
        <p style="margin-bottom: 20px; font-size: 12px; color: var(--text-gray);">Transaction ID: <span id="depositPopupId" style="color: var(--gold); font-weight: bold;"></span></p>
        <button style="background: var(--gold); color: #000; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold;" onclick="closeDepositPopup()">OK</button>
      </div>
    </div>

    <a href="https://t.me/GlowBet_support" target="_blank" class="customer-support" title="Customer Support">üí¨</a>

    <!-- LOGIN PAGE -->
    <div class="auth-container" id="loginPage">
      <div class="auth-box">
        <h1 style="text-align: center; font-size: 32px; font-weight: bold; margin-bottom: 10px; color: var(--gold);">GlowBet</h1>
        <p style="text-align: center; font-size: 14px; color: var(--text-gray); margin-bottom: 30px;">Premium Gaming Experience</p>
        
        <div style="margin-bottom: 25px;">
          <div style="text-align: center; padding: 12px; border-radius: 10px; font-weight: 500; color: var(--gold); background: rgba(255, 183, 3, 0.2);">Login</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Phone number</label>
          <div style="display: flex; align-items: center; background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 5px; border: 1px solid #333;">
            <div style="padding: 12px 15px; background: rgba(255, 183, 3, 0.1); border-radius: 8px; color: var(--gold); font-weight: 500; display: flex; align-items: center; gap: 8px; min-width: 80px;">+91</div>
            <input type="tel" class="form-input" style="border: none; background: transparent;" id="loginPhone" placeholder="Enter phone number">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" id="loginPassword" placeholder="Password">
        </div>
        
        <div style="display: flex; align-items: center; gap: 8px; margin: 20px 0; color: var(--text-gray); font-size: 14px;">
          <input type="checkbox" style="width: 18px; height: 18px; accent-color: var(--gold); cursor: pointer;" id="rememberPassword">
          <label for="rememberPassword">Remember password</label>
        </div>
        
        <button class="submit-btn" onclick="login()">Log in</button>
        
        <div class="toggle-auth">
          Don't have an account? <span onclick="showRegisterPage()">Register Now</span>
        </div>
        
        <div style="text-align: center; margin-top: 10px; color: var(--text-gray); font-size: 12px;">
          <a href="https://t.me/GlowBet_support" target="_blank" style="color: var(--gold); text-decoration: none;">Need Help? Contact Support</a>
        </div>
      </div>
    </div>

    <!-- REGISTER PAGE -->
    <div class="auth-container hidden" id="registerPage">
      <div class="auth-box">
        <h1 style="text-align: center; font-size: 32px; font-weight: bold; margin-bottom: 10px; color: var(--gold);">GlowBet</h1>
        <p style="text-align: center; font-size: 14px; color: var(--text-gray); margin-bottom: 30px;">Create Account</p>
        
        <div style="margin-bottom: 25px;">
          <div style="text-align: center; padding: 12px; border-radius: 10px; font-weight: 500; color: var(--gold); background: rgba(255, 183, 3, 0.2);">Register</div>
        </div>

        <div class="form-group">
          <label class="form-label">Full Name</label>
          <input type="text" class="form-input" id="regName" placeholder="Enter your name">
        </div>
        
        <div class="form-group">
          <label class="form-label">Phone number</label>
          <div style="display: flex; align-items: center; background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 5px; border: 1px solid #333;">
            <div style="padding: 12px 15px; background: rgba(255, 183, 3, 0.1); border-radius: 8px; color: var(--gold); font-weight: 500; display: flex; align-items: center; gap: 8px; min-width: 80px;">+91</div>
            <input type="tel" class="form-input" style="border: none; background: transparent;" id="regPhone" placeholder="Enter phone number">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" id="regPassword" placeholder="Create password">
        </div>

        <div class="form-group">
          <label class="form-label">Confirm Password</label>
          <input type="password" class="form-input" id="regConfirmPassword" placeholder="Confirm password">
        </div>
        
        <button class="submit-btn" onclick="register()">Create Account</button>
        
        <div class="toggle-auth">
          Already have an account? <span onclick="showLoginPage()">Login Now</span>
        </div>
        
        <div style="text-align: center; margin-top: 10px; color: var(--text-gray); font-size: 12px;">
          <a href="https://t.me/GlowBet_support" target="_blank" style="color: var(--gold); text-decoration: none;">Need Help? Contact Support</a>
        </div>
      </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
      <header>
        <div class="header-top">
          <div class="user-pill" id="userPill" onclick="openGiftCodeModal()">
            <span id="username">User</span>
            <span style="opacity: 0.7;">|</span>
            <span>VIP 1</span>
          </div>
          <div class="notif-badge" onclick="showNotifications()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
            <span class="badge-count" id="notif-count">0</span>
          </div>
        </div>
        <div style="font-weight: bold; font-size: 18px; color: var(--gold);" id="page-title">GlowBet</div>
      </header>

      <!-- === HOME PAGE === -->
      <main id="page-home" class="page-section">
        <div class="balance-card">
          <div class="flex justify-between">
            <div>
              <div class="balance-label">Today's Bonus</div>
              <div class="balance-amount">‚Çπ0.00</div>
            </div>
            <div style="text-align: right;">
              <div class="balance-label">Wallet Balance</div>
              <div class="balance-amount text-gold" id="homeBalance">‚Çπ0.00</div>
            </div>
          </div>
          <div style="margin-top: 15px; text-align: center;">
            <button style="background: var(--gold); border: none; padding: 5px 15px; border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 12px; color: #000;" onclick="openGiftCodeModal()">Redeem Gift Code</button>
          </div>
        </div>

        <div class="feature-grid">
          <div class="feature-item" onclick="switchTab('activity')">
            <div class="icon-circle">üìä</div>
            <div class="feature-text">My Bets</div>
          </div>
          <div class="feature-item" onclick="showToast('Betting rebate coming soon!')">
            <div class="icon-circle">üéüÔ∏è</div>
            <div class="feature-text">Rebate</div>
          </div>
          <div class="feature-item" onclick="openGiftCodeModal()">
            <div class="icon-circle">üéÅ</div>
            <div class="feature-text">Gift Code</div>
          </div>
          <div class="feature-item" onclick="switchTab('wallet')">
            <div class="icon-circle">üí∞</div>
            <div class="feature-text">Wallet</div>
          </div>
        </div>

        <div class="banner-area">
          <div style="font-size: 12px; color: var(--gold); margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px;">POPULAR GAMES</div>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px;">
            <div class="feature-item" onclick="openWingo()">
              <div class="icon-circle" style="background: rgba(255, 183, 3, 0.1); color: var(--gold);">üé≤</div>
              <div class="feature-text">Wingo</div>
            </div>
            <div class="feature-item" onclick="showToast('Coming soon!')">
              <div class="icon-circle" style="background: rgba(255, 183, 3, 0.1); color: var(--gold);">üé∞</div>
              <div class="feature-text">Lottery</div>
            </div>
            <div class="feature-item" onclick="showToast('Coming soon!')">
              <div class="icon-circle" style="background: rgba(255, 183, 3, 0.1); color: var(--gold);">üöÄ</div>
              <div class="feature-text">Aviator</div>
            </div>
          </div>
        </div>

        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
          <div class="banner-area w-full" style="margin-bottom: 0; display: flex; align-items: center; justify-content: space-between;">
            <div>
              <div style="color: var(--gold); font-weight: bold;">Deposit</div>
              <div style="font-size: 10px; color: #aaa;">Add Funds</div>
            </div>
            <div>
              <button class="join-btn" onclick="showDepositPage()">Add</button>
              <button class="join-btn" onclick="showDepositHistory()" style="margin-left: 5px; background: #8B5CF6;">History</button>
            </div>
          </div>
          <div class="banner-area w-full" style="margin-bottom: 0; display: flex; align-items: center; justify-content: space-between;">
            <div>
              <div style="color: var(--gold); font-weight: bold;">Withdraw</div>
              <div style="font-size: 10px; color: #aaa;">Cash Out</div>
            </div>
            <div>
              <button class="join-btn" onclick="showWithdrawalPage()">Cash Out</button>
              <button class="join-btn" onclick="showWithdrawalHistory()" style="margin-left: 5px; background: #8B5CF6;">History</button>
            </div>
          </div>
        </div>

        <div class="admin-message-section" id="adminMessageSection" style="display: none;">
          <h4>üì¢ Admin Message</h4>
          <div id="adminMessageContent" style="color: #f1f5f9; font-size: 14px;">Loading...</div>
        </div>
      </main>

      <!-- === WALLET PAGE === -->
      <main id="page-wallet" class="page-section hidden">
        <button class="back-button" onclick="switchTab('home')">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">My Wallet</h2>
        </div>
        <div class="wallet-balance-card">
          <div class="balance-label">Total Balance</div>
          <div class="wallet-balance-value" id="walletBalance">‚Çπ0.00</div>
          <button class="refresh-btn" onclick="refreshWalletBalance()" style="margin: 10px auto; display: block;">üîÑ Refresh Balance</button>
          <div style="display: flex; gap: 15px; margin-top: 20px;">
            <button class="wallet-action-button" onclick="showDepositPage()">Deposit</button>
            <button class="wallet-action-button" onclick="showWithdrawalPage()">Withdraw</button>
          </div>
          <div style="display: flex; gap: 15px; margin-top: 10px;">
            <button class="wallet-action-button" onclick="showDepositHistory()" style="background: #8B5CF6;">Deposit History</button>
            <button class="wallet-action-button" onclick="showWithdrawalHistory()" style="background: #8B5CF6;">Withdrawal History</button>
          </div>
        </div>
      </main>

      <!-- === ACCOUNT PAGE === -->
      <main id="page-account" class="page-section hidden">
        <button class="back-button" onclick="switchTab('home')">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">My Account</h2>
        </div>
        <div class="profile-card">
          <div class="profile-avatar">üë§</div>
          <div style="text-align: center; color: var(--text-gray); margin-bottom: 10px;" id="profilePhone">+91 **********</div>
          <div style="background: rgba(255, 183, 3, 0.1); padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 14px; color: var(--text-gray); text-align: center;">
            <strong style="color: var(--gold);">User ID:</strong> <span id="displayUserId" style="color: white;">Loading...</span>
          </div>
        </div>
        <button class="wallet-action-button" onclick="openGiftCodeModal()" style="background: #8B5CF6; margin-bottom: 10px;">üéÅ Redeem Gift Code</button>
        <button class="wallet-action-button" onclick="logout()" style="background: #333; color: white;">Logout</button>
      </main>

      <!-- === ACTIVITY PAGE === -->
      <main id="page-activity" class="page-section hidden">
        <button class="back-button" onclick="switchTab('home')">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">My Bets</h2>
        </div>
        <div class="banner-area" id="myBetsContainer">
          <div style="text-align: center; color: var(--text-gray); padding: 20px;">No bets yet</div>
        </div>
      </main>

      <!-- === HISTORY PAGES === -->
      <div class="history-page" id="depositHistoryPage">
        <button class="back-button" onclick="goBackFromDepositHistory()">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">Deposit History</h2>
        </div>
        <div id="depositHistoryContainer">
          <div style="text-align: center; color: var(--text-gray); padding: 20px;">Loading deposit history...</div>
        </div>
      </div>

      <div class="history-page" id="withdrawalHistoryPage">
        <button class="back-button" onclick="goBackFromWithdrawalHistory()">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">Withdrawal History</h2>
        </div>
        <div id="withdrawalHistoryContainer">
          <div style="text-align: center; color: var(--text-gray); padding: 20px;">Loading withdrawal history...</div>
        </div>
      </div>

      <!-- === WINGO GAME PAGE === -->
      <div class="wingo-page" id="wingoPage">
        <button class="back-button" onclick="goBackToHome()">‚Üê Back</button>
        <div class="wingo-header">
          <div class="wingo-title">üé≤ GlowBet Wingo üé≤</div>
          <div style="color: var(--text-gray); font-size: 12px;">1 Minute Game</div>
        </div>
        <div class="balance-section">
          <div style="color: var(--text-gray); margin-bottom: 5px;">Wallet Balance</div>
          <div class="balance-amount" id="wingoBalance">‚Çπ0.00</div>
          <button class="refresh-btn" onclick="refreshWingoBalance()">üîÑ</button>
        </div>
        <div class="wallet-actions">
          <div class="wallet-btn" onclick="showDepositPage()">
            <div style="font-size: 12px;">Deposit</div>
            <div style="font-size: 10px; color: var(--text-gray);">Add Money</div>
          </div>
          <div class="wallet-btn" onclick="showWithdrawalPage()">
            <div style="font-size: 12px;">Withdraw</div>
            <div style="font-size: 10px; color: var(--text-gray);">Cash Out</div>
          </div>
        </div>
        <div class="timer-section">
          <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <div style="color: var(--text-gray);">Period: <span id="currentRoundId" style="color: white; font-weight: bold;">Loading...</span></div>
            <div class="timer" id="countdownTimer">60s</div>
          </div>
          <div style="color: var(--text-gray); font-size: 12px;">Next round starts in</div>
        </div>
        <div class="betting-area" id="bettingArea">
          <div class="color-options">
            <div class="color-option red" onclick="selectBet('red')">üî¥ RED</div>
            <div class="color-option violet" onclick="selectBet('violet')">üü£ VIOLET</div>
            <div class="color-option green" onclick="selectBet('green')">üü¢ GREEN</div>
          </div>
          <div class="number-grid">
            <div class="number-cell number-0" onclick="selectBet(0)">0</div>
            <div class="number-cell number-1" onclick="selectBet(1)">1</div>
            <div class="number-cell number-2" onclick="selectBet(2)">2</div>
            <div class="number-cell number-3" onclick="selectBet(3)">3</div>
            <div class="number-cell number-4" onclick="selectBet(4)">4</div>
            <div class="number-cell number-5" onclick="selectBet(5)">5</div>
            <div class="number-cell number-6" onclick="selectBet(6)">6</div>
            <div class="number-cell number-7" onclick="selectBet(7)">7</div>
            <div class="number-cell number-8" onclick="selectBet(8)">8</div>
            <div class="number-cell number-9" onclick="selectBet(9)">9</div>
          </div>
          <div class="size-options">
            <div class="size-option small-btn" onclick="selectBet('small')">üíé SMALL</div>
            <div class="size-option big-btn" onclick="selectBet('big')">üí∞ BIG</div>
          </div>
        </div>
        <div class="history-section">
          <div class="history-tabs">
            <div class="history-tab active" onclick="showGameHistory()">Game History</div>
            <div class="history-tab" onclick="showMyHistory()">My Bets</div>
          </div>
          <div class="history-content">
            <table style="width: 100%; border-collapse: collapse;" id="historyTable">
              <thead>
                <tr>
                  <th style="padding: 12px 8px; text-align: center; border-bottom: 1px solid #333; background: rgba(255, 183, 3, 0.1); color: var(--gold);">Period</th>
                  <th style="padding: 12px 8px; text-align: center; border-bottom: 1px solid #333; background: rgba(255, 183, 3, 0.1); color: var(--gold);">Number</th>
                  <th style="padding: 12px 8px; text-align: center; border-bottom: 1px solid #333; background: rgba(255, 183, 3, 0.1); color: var(--gold);">Size</th>
                  <th style="padding: 12px 8px; text-align: center; border-bottom: 1px solid #333; background: rgba(255, 183, 3, 0.1); color: var(--gold);">Color</th>
                </tr>
              </thead>
              <tbody id="historyTableBody">
                <tr>
                  <td colspan="4" style="text-align: center; padding: 20px; color: var(--text-gray);">Loading results...</td>
                </tr>
              </tbody>
            </table>
            <div style="display: flex; justify-content: center; align-items: center; margin-top: 15px; gap: 15px;">
              <button style="background: rgba(255, 183, 3, 0.1); color: var(--gold); border: 1px solid #333; padding: 10px 15px; border-radius: 8px; cursor: pointer;" id="prevPageBtn" onclick="previousPage()" disabled>‚Üê Previous</button>
              <div style="font-weight: bold; color: var(--gold); font-size: 14px;">Page <span id="currentPageNum">1</span> of <span id="totalPagesNum">1</span></div>
              <button style="background: rgba(255, 183, 3, 0.1); color: var(--gold); border: 1px solid #333; padding: 10px 15px; border-radius: 8px; cursor: pointer;" id="nextPageBtn" onclick="nextPage()">Next ‚Üí</button>
            </div>
          </div>
        </div>
      </div>

      <!-- === DEPOSIT PAGE === -->
      <div class="deposit-page" id="depositPage">
        <button class="back-button" onclick="goBackFromDeposit()">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">Deposit</h2>
          <p style="color: var(--text-gray); font-size: 14px; margin-top: 5px;">Balance: ‚Çπ100 - ‚Çπ50,000</p>
        </div>
        
        <div class="deposit-form-card">
          <div class="form-group">
            <label class="form-label">Select Deposit Amount</label>
            <div class="amount-grid" id="amountGrid"></div>
            <div style="margin-top: 15px; display: flex; align-items: center; gap: 10px;">
              <div style="color: var(--text-gray); font-size: 14px;">Custom Amount:</div>
              <input type="number" class="form-input" id="customAmount" placeholder="Enter amount" min="100" max="50000" style="flex: 1; padding: 10px;" oninput="selectCustomAmount()">
            </div>
            <div style="margin-top: 10px; color: var(--gold); font-size: 13px; text-align: center;">Selected Amount: <strong id="selectedAmountDisplay">‚Çπ0</strong></div>
          </div>

          <div id="qrSection" class="hidden">
            <div class="qr-code-section">
              <h3 style="color: var(--gold); margin-bottom: 10px;">Scan QR Code to Pay</h3>
              <p style="color: var(--text-gray); margin-bottom: 15px; font-size: 14px;">Scan this QR with any UPI app to deposit funds</p>
              <div class="qr-code-image">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=280x280&data=upi://pay?pa=glowbet@upi&pn=GlowBet&am=100&cu=INR" alt="GlowBet QR Code" id="qrCodeImage">
              </div>
              <div style="margin-top: 15px; padding: 10px; background: rgba(255, 183, 3, 0.1); border-radius: 8px;">
                <p style="color: var(--text-gray); font-size: 16px; margin-bottom: 5px;">Payment Details:</p>
                <p style="font-size: 18px; font-weight: bold; color: var(--gold);">Amount: <span id="qrAmountDisplay">‚Çπ0</span></p>
                <p style="font-size: 12px; color: var(--text-gray); margin-top: 5px;">UPI ID: <strong>glowbet@upi</strong></p>
              </div>
            </div>
            
            <div class="guidelines-section">
              <div style="color: #FBBF24; font-weight: bold; margin-bottom: 10px; text-align: center;">Important Guidelines:</div>
              <ul class="guidelines-list">
                <li>Scan QR code with any UPI app (PhonePe, GPay, Paytm)</li>
                <li>Amount will auto-fill from your selection</li>
                <li>Payment will be processed within 5-10 minutes</li>
                <li>Keep transaction ID (UTR) for reference</li>
                <li>Minimum deposit: ‚Çπ100 | Maximum: ‚Çπ50,000</li>
                <li>After payment, enter UTR below</li>
              </ul>
            </div>
            
            <div class="form-group" style="margin-top: 20px;">
              <label class="form-label">Enter UPI Transaction ID (12-digit UTR)</label>
              <input type="text" class="form-input" id="utrNumber" placeholder="Enter 12-digit UTR number from payment receipt" maxlength="12">
              <div style="font-size: 11px; color: var(--text-gray); margin-top: 5px;">Find UTR in your payment receipt from bank/UPI app</div>
            </div>
            
            <button class="submit-btn" id="depositSubmitBtn" onclick="submitDeposit()" disabled>Submit Deposit Request</button>
          </div>
          
          <button class="submit-btn" id="showQRBtn" onclick="showQRCode()">Show QR Code for Deposit</button>
        </div>
      </div>

      <!-- === WITHDRAWAL PAGE === -->
      <div class="withdrawal-page" id="withdrawalPage">
        <button class="back-button" onclick="goBackFromWithdrawal()">‚Üê Back</button>
        <div style="margin-top: 50px; text-align: center;">
          <h2 style="color: var(--gold); font-size: 2rem;">Withdraw</h2>
        </div>
        <div class="deposit-form-card">
          <div class="form-group">
            <label class="form-label">Enter Amount (Min ‚Çπ100)</label>
            <input type="number" class="form-input" id="withdrawalAmount" placeholder="‚Çπ100" min="100" value="100">
          </div>
          <div class="form-group">
            <label class="form-label">UPI ID</label>
            <input type="text" class="form-input" id="withdrawalDetails" placeholder="Enter your UPI ID">
          </div>
          <button class="submit-btn" onclick="processWithdrawal()">Request Withdrawal</button>
        </div>
      </div>

      <nav class="bottom-nav" id="bottomNav">
        <div class="nav-item active" onclick="switchTab('home')"><div class="nav-icon">üè†</div><div>HOME</div></div>
        <div class="nav-item" onclick="switchTab('activity')"><div class="nav-icon">üìä</div><div>MY BETS</div></div>
        <div class="nav-item" onclick="switchTab('wallet')"><div class="nav-icon">üí∞</div><div>WALLET</div></div>
        <div class="nav-item" onclick="switchTab('account')"><div class="nav-icon">üë§</div><div>ACCOUNT</div></div>
      </nav>
    </div>
  </div>

  <!-- Bet Popup -->
  <div class="bet-popup" id="betPopup">
    <div class="bet-popup-content">
      <h3 style="color: var(--gold); margin-bottom: 10px;">Place Your Bet</h3>
      <div id="betSelection" style="font-size: 1.2rem; margin: 10px 0; font-weight: bold; color: white;"></div>
      <div class="bet-amount">
        <button class="amount-btn" onclick="changeAmount(-10)">-</button>
        <div class="amount-display" id="betAmount" onclick="openCustomAmount()">100</div>
        <button class="amount-btn" onclick="changeAmount(10)">+</button>
      </div>
      <div style="display: flex; justify-content: space-between; margin: 10px 0; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
        <span style="color: var(--text-gray);">Bet Amount:</span>
        <span id="betAmountDisplay" style="color: var(--gold); font-weight: bold;">‚Çπ100</span>
      </div>
      <div class="bet-actions">
        <button class="bet-action-btn cancel-btn" onclick="closeBetPopup()">Cancel</button>
        <button class="bet-action-btn place-bet-btn" onclick="placeBet()">Place Bet</button>
      </div>
    </div>
  </div>

  <div class="bet-popup" id="customAmountModal">
    <div class="bet-popup-content">
      <h3 style="color: var(--gold); margin-bottom: 10px;">Enter Custom Amount</h3>
      <input type="number" class="form-input" id="customAmountInput" placeholder="Enter amount" min="10" style="font-size: 1.5rem; text-align: center;">
      <div class="bet-actions" style="margin-top: 20px;">
        <button class="bet-action-btn cancel-btn" onclick="closeCustomAmount()">Cancel</button>
        <button class="bet-action-btn place-bet-btn" onclick="applyCustomAmount()">Apply</button>
      </div>
    </div>
  </div>

  <script>
    // ===========================
    // FIREBASE CONFIGURATION
    // ===========================
    const firebaseConfig = {
      apiKey: "AIzaSyCAHzv-VxvatsG9CFsCzbrNx9X6uaKRAa4",
      authDomain: "glowbet-1b2ce.firebaseapp.com",
      databaseURL: "https://glowbet-1b2ce-default-rtdb.firebaseio.com/",
      projectId: "glowbet-1b2ce",
      storageBucket: "glowbet-1b2ce.firebasestorage.app",
      messagingSenderId: "333266810255",
      appId: "1:333266810255:web:877010652ce46c8af687fa",
      measurementId: "G-53QM377N5M"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    let audioContext = null;
    let isBeepPlaying = false;
    let isWingoPageActive = false;

    function playBeepSound() {
      if (!isWingoPageActive) return;
      if (!audioContext) audioContext = new (window.AudioContext || window.webkitAudioContext)();
      if (isBeepPlaying) return;
      isBeepPlaying = true;
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      oscillator.frequency.value = 800;
      oscillator.type = 'sine';
      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.2);
      setTimeout(() => isBeepPlaying = false, 200);
    }

    let currentUser = null;
    let currentBet = null;
    let betAmount = 100;
    let countdown = 60;
    let countdownInterval = null;
    let currentPage = 1;
    const RESULTS_PER_PAGE = 10;
    let allResults = [];
    let isBettingLocked = false;
    let currentRoundId = null;
    let activeTab = 'home';
    let pendingResultCheck = null;
    let betLockTimer = null;
    let selectedDepositAmount = 0;
    const depositAmounts = [100, 200, 300, 500, 800, 900, 1100];

    // ===========================
    // FIXED: PERIOD GENERATION
    // ===========================
    function generatePeriodNumber(dateInput) {
      const now = dateInput ? new Date(dateInput) : new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const totalMinutesSinceMidnight = (hours * 60) + minutes;
      const periodNumber = String(totalMinutesSinceMidnight + 1).padStart(4, '0');
      return `${year}${month}${day}${periodNumber}`;
    }

    function updatePeriodAndTimer() {
      if (!isWingoPageActive) return;
      const now = new Date();
      const seconds = now.getSeconds();
      const remainingSeconds = 60 - seconds;
      
      currentRoundId = generatePeriodNumber(now);
      const roundIdElement = document.getElementById('currentRoundId');
      if (roundIdElement) roundIdElement.textContent = currentRoundId.slice(-4);
      
      const timerEl = document.getElementById('countdownTimer');
      if (timerEl) {
        timerEl.textContent = `${remainingSeconds}s`;
        countdown = remainingSeconds;
        
        if (remainingSeconds <= 5) {
          timerEl.classList.add('urgent');
          playBeepSound();
          lockBettingForLast5Seconds();
        } else {
          timerEl.classList.remove('urgent');
          unlockBettingForNewRound();
        }
        
        if (remainingSeconds === 60) {
          processRoundResult();
        }
      }
    }

    // ===========================
    // FIXED: FULL LOTTERY RANDOM LOGIC
    // ===========================
    function processRoundResult() {
      if (!isWingoPageActive) return;
      const previousTime = new Date(Date.now() - 1000);
      const resolvedPeriodId = generatePeriodNumber(previousTime);
      const randomNum = Math.floor(Math.random() * 10);
      
      const result = {
        number: randomNum,
        colors: getColorForNumber(randomNum),
        size: randomNum >= 5 ? 'big' : 'small',
        period: resolvedPeriodId,
        timestamp: Date.now(),
        source: 'lottery_random'
      };
      
      database.ref('results/' + resolvedPeriodId).set(result);
      allResults.unshift(result);
      if (allResults.length > 20) allResults.pop();
      
      checkUserBetsForRound(resolvedPeriodId, result);
      setTimeout(() => unlockAllButtons(), 2000);
    }

    function getColorForNumber(number) {
      if (number === 0) return ['red', 'violet'];
      if (number === 5) return ['green', 'violet'];
      if ([1, 3, 7, 9].includes(number)) return ['green'];
      return ['red'];
    }

    // ===========================
    // UI & NOTIFICATIONS
    // ===========================
    function showToast(message) {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.innerText = message;
      container.appendChild(toast);
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(-20px)';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    function showInsufficientBalance() {
      const appContainer = document.getElementById('appContainer');
      const overlay = document.getElementById('insufficientOverlay');
      overlay.style.display = 'block';
      appContainer.classList.add('shake');
      if (!audioContext) audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();
      osc.connect(gain);
      gain.connect(audioContext.destination);
      osc.frequency.value = 200;
      osc.type = 'sawtooth';
      gain.gain.setValueAtTime(0.3, audioContext.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
      osc.start();
      osc.stop(audioContext.currentTime + 0.3);
      setTimeout(() => {
        appContainer.classList.remove('shake');
        overlay.style.display = 'none';
      }, 1500);
    }

    function unlockAllButtons() {
      isBettingLocked = false;
      const bettingArea = document.getElementById('bettingArea');
      if (bettingArea) {
        bettingArea.querySelectorAll('.color-option, .number-cell, .size-option').forEach(el => el.classList.remove('disabled'));
      }
    }

    function lockBettingForLast5Seconds() {
      if (countdown <= 5 && !isBettingLocked && isWingoPageActive) {
        isBettingLocked = true;
        const bettingArea = document.getElementById('bettingArea');
        if (bettingArea) {
          bettingArea.querySelectorAll('.color-option, .number-cell, .size-option').forEach(el => el.classList.add('disabled'));
        }
      }
    }

    function unlockBettingForNewRound() {
      if (countdown > 5 && isBettingLocked && isWingoPageActive) {
        isBettingLocked = false;
        const bettingArea = document.getElementById('bettingArea');
        if (bettingArea) {
          bettingArea.querySelectorAll('.color-option, .number-cell, .size-option').forEach(el => el.classList.remove('disabled'));
        }
      }
    }

    // ===========================
    // AUTHENTICATION (LOGIN & REGISTER)
    // ===========================
    function checkAutoLogin() {
      const savedUser = localStorage.getItem('glowbet_user');
      if (savedUser) {
        try {
          currentUser = JSON.parse(savedUser);
          const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
          database.ref('users/' + cleanPhone).once('value').then(snapshot => {
            if (snapshot.exists()) {
              const userData = snapshot.val();
              if (userData.status === 'banned') {
                currentUser = null;
                localStorage.removeItem('glowbet_user');
                showToast("Your account has been banned");
              } else {
                currentUser = userData;
                localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
                document.getElementById("loginPage").classList.add("hidden");
                document.getElementById("registerPage").classList.add("hidden");
                document.getElementById("mainApp").classList.remove("hidden");
                switchTab('home');
                checkPendingBets();
                loadAdminMessage();
              }
            } else {
              currentUser = null;
              localStorage.removeItem('glowbet_user');
            }
          }).catch(error => {
            console.error("Auto login error:", error);
            currentUser = null;
            localStorage.removeItem('glowbet_user');
          });
        } catch (e) {
          console.error("Error parsing saved user:", e);
          localStorage.removeItem('glowbet_user');
        }
      }
    }

    function login() {
      const phone = document.getElementById('loginPhone').value;
      const password = document.getElementById('loginPassword').value;
      if (!phone || !password) {
        showToast("Please enter phone number and password");
        return;
      }

      const cleanPhone = phone.replace(/[^0-9]/g, '');
      database.ref('users/' + cleanPhone).once('value').then(snapshot => {
        const userData = snapshot.val();
        if (userData && userData.password === password) {
          if (userData.status === 'banned') {
            showToast("Your account has been banned");
            return;
          }
          proceedLogin(userData);
        } else {
          showToast("Invalid Phone Number or Password");
        }
      }).catch(error => {
        console.error("Login error:", error);
        showToast("Login failed. Please try again.");
      });
    }

    function showLoginPage() {
      document.getElementById('registerPage').classList.add('hidden');
      document.getElementById('loginPage').classList.remove('hidden');
    }

    function showRegisterPage() {
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('registerPage').classList.remove('hidden');
    }

    function register() {
      const name = document.getElementById('regName').value;
      const phone = document.getElementById('regPhone').value;
      const password = document.getElementById('regPassword').value;
      const confirmPassword = document.getElementById('regConfirmPassword').value;

      if (!name || !phone || !password || !confirmPassword) {
        showToast("Please fill all fields");
        return;
      }

      if (password !== confirmPassword) {
        showToast("Passwords do not match");
        return;
      }

      const cleanPhone = phone.replace(/[^0-9]/g, '');
      
      database.ref('users/' + cleanPhone).once('value').then(snapshot => {
        if (snapshot.exists()) {
          showToast("Phone number already registered. Please Login.");
          return;
        }

        const userId = 'GB' + Date.now().toString().slice(-8);
        const newUser = {
          name: name,
          phone: phone,
          password: password,
          balance: 28, // Fixed Signup Bonus 28
          userId: userId,
          status: 'active',
          registeredDate: new Date().toISOString(),
          inviteCode: '663221064676'
        };
        
        database.ref('users/' + cleanPhone).set(newUser).then(() => {
          showToast("Registration Successful! Please Login.");
          showLoginPage();
        }).catch(error => {
          console.error("Registration error:", error);
          showToast("Registration failed. Try again.");
        });
      }).catch(error => {
        console.error("Error checking phone:", error);
        showToast("Connection error. Try again.");
      });
    }

    function proceedLogin(userData) {
      currentUser = userData;
      localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
      showToast("Login successful!");
      setTimeout(() => {
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("registerPage").classList.add("hidden");
        document.getElementById("mainApp").classList.remove("hidden");
        switchTab('home');
        checkPendingBets();
        loadAdminMessage();
      }, 1000);
    }

    function loadAdminMessage() {
      database.ref('admin_message').once('value').then(snapshot => {
        const message = snapshot.val();
        if (message && message.text) {
          document.getElementById('adminMessageSection').style.display = 'block';
          document.getElementById('adminMessageContent').innerHTML = message.text;
        }
      });
    }

    function switchTab(tabId) {
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('wingoPage').style.display = 'none';
      document.getElementById('depositPage').style.display = 'none';
      document.getElementById('withdrawalPage').style.display = 'none';
      document.getElementById('depositHistoryPage').style.display = 'none';
      document.getElementById('withdrawalHistoryPage').style.display = 'none';

      document.getElementById('bottomNav').classList.remove('hide-nav');

      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      const navItems = document.querySelectorAll('.nav-item');
      if(tabId === 'home') navItems[0].classList.add('active');
      else if(tabId === 'activity') navItems[1].classList.add('active');
      else if(tabId === 'wallet') navItems[2].classList.add('active');
      else if(tabId === 'account') navItems[3].classList.add('active');

      if (tabId === 'home' || tabId === 'wallet' || tabId === 'account' || tabId === 'activity') {
        document.getElementById('page-' + tabId).classList.remove('hidden');
        document.getElementById('page-title').textContent = 
          tabId === 'home' ? 'GlowBet' : 
          tabId === 'wallet' ? 'Wallet' : 
          tabId === 'account' ? 'Account' : 'My Bets';
        
        if (currentUser) {
          updateUserInfo();
          if (tabId === 'activity') {
            loadMyBets();
          }
        }
      }

      activeTab = tabId;
      window.scrollTo(0, 0);
    }

    function updateUserInfo() {
      if (!currentUser) return;
      document.getElementById('homeBalance').textContent = `‚Çπ${currentUser.balance.toFixed(2)}`;
      document.getElementById('walletBalance').textContent = `‚Çπ${currentUser.balance.toFixed(2)}`;
      document.getElementById('wingoBalance').textContent = `‚Çπ${currentUser.balance.toFixed(2)}`;
      document.getElementById('profilePhone').textContent = currentUser.phone || 'N/A';
      document.getElementById('displayUserId').textContent = currentUser.userId || 'N/A';
      document.getElementById('username').textContent = currentUser.userId ? currentUser.userId.substring(0, 6) : 'User';
    }

    function openWingo() {
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('wingoPage').style.display = 'block';
      document.getElementById('bottomNav').classList.add('hide-nav');
      document.getElementById('page-title').textContent = 'Wingo Game';
      isWingoPageActive = true;
      initializeWingo();
    }

    function initializeWingo() {
      updateUserInfo();
      startCountdown();
      unlockAllButtons();
    }

    function startCountdown() {
      clearInterval(countdownInterval);
      updatePeriodAndTimer();
      countdownInterval = setInterval(() => {
        updatePeriodAndTimer();
      }, 1000);
      listenToFirebaseResults();
      checkPendingBets();
    }

    function changeAmount(delta) {
      betAmount = Math.max(10, betAmount + delta);
      document.getElementById('betAmount').textContent = betAmount;
      document.getElementById('betAmountDisplay').textContent = `‚Çπ${betAmount}`;
    }

    function openCustomAmount() {
      document.getElementById('customAmountModal').style.display = 'flex';
      document.getElementById('customAmountInput').value = betAmount;
      document.getElementById('customAmountInput').focus();
    }

    function closeCustomAmount() {
      document.getElementById('customAmountModal').style.display = 'none';
    }

    function applyCustomAmount() {
      const customValue = parseInt(document.getElementById('customAmountInput').value);
      if (customValue && customValue >= 10) {
        betAmount = customValue;
        document.getElementById('betAmount').textContent = betAmount;
        document.getElementById('betAmountDisplay').textContent = `‚Çπ${betAmount}`;
      }
      closeCustomAmount();
    }

    function closeBetPopup() {
      document.getElementById('betPopup').style.display = 'none';
    }

    function showWinPopup(amount) {
      document.getElementById('winAmount').textContent = `You won ‚Çπ${amount.toFixed(2)}!`;
      document.getElementById('winPopup').style.display = 'flex';
      setTimeout(() => closeWinPopup(), 3000);
    }

    function closeWinPopup() {
      document.getElementById('winPopup').style.display = 'none';
    }

    function showLosePopup(amount) {
      document.getElementById('loseAmount').textContent = `You lost ‚Çπ${amount.toFixed(2)}`;
      document.getElementById('losePopup').style.display = 'flex';
      setTimeout(() => closeLosePopup(), 3000);
    }

    function closeLosePopup() {
      document.getElementById('losePopup').style.display = 'none';
    }

    function openGiftCodeModal() {
      document.getElementById('giftCodeModal').style.display = 'flex';
    }

    function closeGiftCodeModal() {
      document.getElementById('giftCodeModal').style.display = 'none';
      document.getElementById('giftCodeInput').value = '';
    }

    function closeDepositPopup() {
      document.getElementById('depositPopup').style.display = 'none';
    }

    function redeemGiftCode() {
      const code = document.getElementById('giftCodeInput').value.trim().toUpperCase();
      if (!code) { showToast('Please enter gift code'); return; }
      if (!currentUser) { showToast('Please login first'); return; }
      database.ref('gift_codes/' + code).once('value').then(snapshot => {
        const giftCode = snapshot.val();
        if (!giftCode) { showToast('‚ùå Invalid gift code'); return; }
        if (giftCode.status !== 'active') { showToast('‚ùå Gift code already used or expired'); return; }
        if (giftCode.maxUsers > 0 && (giftCode.usedCount || 0) >= giftCode.maxUsers) { showToast('‚ùå Gift code usage limit reached'); return; }
        
        const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
        const newBalance = (currentUser.balance || 0) + giftCode.amount;
        database.ref('users/' + cleanPhone + '/balance').set(newBalance).then(() => {
          const updates = {};
          updates['gift_codes/' + code + '/usedCount'] = (giftCode.usedCount || 0) + 1;
          updates['gift_codes/' + code + '/usedBy/' + cleanPhone] = true;
          if (giftCode.maxUsers > 0 && (giftCode.usedCount || 0) + 1 >= giftCode.maxUsers) updates['gift_codes/' + code + '/status'] = 'used';
          database.ref().update(updates).then(() => {
            currentUser.balance = newBalance;
            localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
            showToast(`üéâ Gift code redeemed! ‚Çπ${giftCode.amount} added to your balance`);
            updateUserInfo();
            closeGiftCodeModal();
          });
        });
      }).catch(error => { console.error('Error redeeming gift code:', error); showToast('‚ùå Error redeeming gift code'); });
    }

    // Deposit & Withdrawal Logic
    function initializeDepositPage() {
      const amountGrid = document.getElementById('amountGrid');
      amountGrid.innerHTML = '';
      depositAmounts.forEach(amount => {
        const option = document.createElement('div');
        option.className = 'amount-option';
        option.textContent = `‚Çπ${amount}`;
        option.dataset.amount = amount;
        option.onclick = () => selectAmount(amount);
        amountGrid.appendChild(option);
      });
      selectedDepositAmount = 0;
      document.getElementById('selectedAmountDisplay').textContent = '‚Çπ0';
      document.getElementById('customAmount').value = '';
      document.getElementById('qrSection').classList.add('hidden');
      document.getElementById('showQRBtn').style.display = 'block';
      document.getElementById('depositSubmitBtn').disabled = true;
    }
    
    function selectAmount(amount) {
      selectedDepositAmount = amount;
      document.getElementById('selectedAmountDisplay').textContent = `‚Çπ${amount}`;
      document.getElementById('customAmount').value = amount;
      document.querySelectorAll('.amount-option').forEach(opt => opt.classList.remove('selected'));
      document.querySelector(`.amount-option[data-amount="${amount}"]`).classList.add('selected');
      document.getElementById('showQRBtn').disabled = false;
    }
    
    function selectCustomAmount() {
      const customAmount = parseInt(document.getElementById('customAmount').value);
      if (customAmount && customAmount >= 100 && customAmount <= 50000) {
        selectedDepositAmount = customAmount;
        document.getElementById('selectedAmountDisplay').textContent = `‚Çπ${customAmount}`;
        document.querySelectorAll('.amount-option').forEach(opt => opt.classList.remove('selected'));
        document.getElementById('showQRBtn').disabled = false;
      } else {
        selectedDepositAmount = 0;
        document.getElementById('selectedAmountDisplay').textContent = '‚Çπ0';
        document.getElementById('showQRBtn').disabled = true;
      }
    }
    
    function showQRCode() {
      if (selectedDepositAmount < 100 || selectedDepositAmount > 50000) {
        showToast('Please select amount between ‚Çπ100 - ‚Çπ50,000');
        return;
      }
      document.getElementById('qrSection').classList.remove('hidden');
      document.getElementById('showQRBtn').style.display = 'none';
      document.getElementById('qrAmountDisplay').textContent = `‚Çπ${selectedDepositAmount}`;
      document.getElementById('qrCodeImage').src = `https://api.qrserver.com/v1/create-qr-code/?size=280x280&data=upi://pay?pa=glowbet@upi&pn=GlowBet&am=${selectedDepositAmount}&cu=INR`;
      document.getElementById('depositSubmitBtn').disabled = false;
      document.getElementById('qrSection').scrollIntoView({ behavior: 'smooth' });
    }
    
    function submitDeposit() {
      const utr = document.getElementById('utrNumber').value.trim();
      if (!utr || utr.length < 10) { showToast('Please enter valid UTR number (min 10 digits)'); return; }
      if (!currentUser) { showToast('Please login first'); return; }
      const depositId = 'DEP' + Date.now().toString().slice(-10);
      const depositData = {
        depositId: depositId, userId: currentUser.userId, phone: currentUser.phone, amount: selectedDepositAmount, method: 'qr', utr: utr, status: 'pending', timestamp: Date.now(), date: new Date().toISOString()
      };
      database.ref('deposits/' + depositId).set(depositData).then(() => {
        document.getElementById('depositPopupId').textContent = depositId;
        document.getElementById('depositPopup').style.display = 'flex';
        showToast(`‚úÖ Deposit request submitted! ID: ${depositId}`);
        setTimeout(() => {
          initializeDepositPage();
          document.getElementById('utrNumber').value = '';
          goBackFromDeposit();
        }, 2000);
      });
    }

    function processWithdrawal() {
      const amount = parseFloat(document.getElementById('withdrawalAmount').value);
      const upiId = document.getElementById('withdrawalDetails').value;
      if (!amount || amount < 100) { showToast("Minimum withdrawal amount is ‚Çπ100"); return; }
      if (!upiId) { showToast("Please enter UPI ID"); return; }
      if (!currentUser) { showToast("Please login first"); return; }
      if (amount > currentUser.balance) { showInsufficientBalance(); return; }
      const withdrawalId = 'WD' + Date.now().toString().slice(-10);
      const withdrawalData = {
        withdrawalId: withdrawalId, userId: currentUser.userId, phone: currentUser.phone, amount: amount, method: 'upi', upiId: upiId, status: 'pending', timestamp: Date.now(), date: new Date().toISOString()
      };
      currentUser.balance -= amount;
      const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
      database.ref('withdrawals/' + withdrawalId).set(withdrawalData);
      database.ref('users/' + cleanPhone + '/balance').set(currentUser.balance);
      localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
      showToast(`‚úÖ Withdrawal request submitted! ID: ${withdrawalId}`);
      updateUserInfo();
      setTimeout(() => {
        document.getElementById('withdrawalAmount').value = '100';
        document.getElementById('withdrawalDetails').value = '';
        goBackFromWithdrawal();
      }, 2000);
    }

    // History Functions
    function showDepositHistory() {
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('depositHistoryPage').style.display = 'block';
      document.getElementById('bottomNav').classList.add('hide-nav');
      document.getElementById('page-title').textContent = 'Deposit History';
      loadDepositHistory();
    }
    
    function loadDepositHistory() {
      if (!currentUser) return;
      const container = document.getElementById('depositHistoryContainer');
      container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">Loading deposit history...</div>';
      database.ref('deposits').orderByChild('userId').equalTo(currentUser.userId).once('value').then(snapshot => {
        const deposits = snapshot.val();
        if (!deposits) { container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">No deposit history found</div>'; return; }
        container.innerHTML = '';
        const depositArray = Object.values(deposits);
        depositArray.sort((a, b) => b.timestamp - a.timestamp).forEach(deposit => {
          const historyCard = document.createElement('div');
          historyCard.className = 'history-card';
          const statusClass = deposit.status === 'completed' ? 'status-completed' : deposit.status === 'rejected' ? 'status-rejected' : 'status-pending';
          historyCard.innerHTML = `
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><div style="font-weight: bold; color: var(--gold);">${deposit.depositId}</div><div class="${statusClass}">${deposit.status.toUpperCase()}</div></div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><div style="color: white;">Amount: ‚Çπ${deposit.amount}</div><div style="color: white;">UTR: ${deposit.utr || 'N/A'}</div></div>
            <div style="font-size: 12px; color: var(--text-gray);">${new Date(deposit.timestamp).toLocaleString()}</div>
          `;
          container.appendChild(historyCard);
        });
      });
    }
    
    function goBackFromDepositHistory() { switchTab('wallet'); }

    function showWithdrawalHistory() {
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('withdrawalHistoryPage').style.display = 'block';
      document.getElementById('bottomNav').classList.add('hide-nav');
      document.getElementById('page-title').textContent = 'Withdrawal History';
      loadWithdrawalHistory();
    }
    
    function loadWithdrawalHistory() {
      if (!currentUser) return;
      const container = document.getElementById('withdrawalHistoryContainer');
      container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">Loading withdrawal history...</div>';
      database.ref('withdrawals').orderByChild('userId').equalTo(currentUser.userId).once('value').then(snapshot => {
        const withdrawals = snapshot.val();
        if (!withdrawals) { container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">No withdrawal history found</div>'; return; }
        container.innerHTML = '';
        const withdrawalArray = Object.values(withdrawals);
        withdrawalArray.sort((a, b) => b.timestamp - a.timestamp).forEach(withdrawal => {
          const historyCard = document.createElement('div');
          historyCard.className = 'history-card';
          const statusClass = withdrawal.status === 'completed' ? 'status-completed' : withdrawal.status === 'rejected' ? 'status-rejected' : 'status-pending';
          historyCard.innerHTML = `
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><div style="font-weight: bold; color: var(--gold);">${withdrawal.withdrawalId}</div><div class="${statusClass}">${withdrawal.status.toUpperCase()}</div></div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><div style="color: white;">Amount: ‚Çπ${withdrawal.amount}</div><div style="color: white;">UPI: ${withdrawal.upiId || 'N/A'}</div></div>
            <div style="font-size: 12px; color: var(--text-gray);">${new Date(withdrawal.timestamp).toLocaleString()}</div>
          `;
          container.appendChild(historyCard);
        });
      });
    }
    
    function goBackFromWithdrawalHistory() { switchTab('wallet'); }

    function listenToFirebaseResults() {
      database.ref('results').orderByChild('timestamp').limitToLast(100).on('value', (snapshot) => {
        allResults = [];
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          if (data && data.period && data.number !== undefined) allResults.push(data);
        });
        allResults.sort((a, b) => (b.period || '').localeCompare(a.period || ''));
        if (isWingoPageActive) displayResultsForPage(currentPage);
      });
    }

    function displayResultsForPage(pageNum) {
      const startIndex = (pageNum - 1) * RESULTS_PER_PAGE;
      const endIndex = startIndex + RESULTS_PER_PAGE;
      const pageResults = allResults.slice(startIndex, endIndex);
      const tbody = document.getElementById('historyTableBody');
      if (!tbody) return;
      tbody.innerHTML = '';
      if (pageResults.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--text-gray);">No results yet</td></tr>';
      } else {
        pageResults.forEach(result => {
          const row = document.createElement('tr');
          const periodCell = document.createElement('td');
          periodCell.textContent = result.period ? result.period.slice(-4) : 'N/A';
          periodCell.style.padding = '12px 8px'; periodCell.style.textAlign = 'center'; periodCell.style.borderBottom = '1px solid #333'; periodCell.style.color = 'white';
          
          const numberCell = document.createElement('td');
          const numberSpan = document.createElement('span');
          numberSpan.style = 'font-weight: bold; display: inline-block; padding: 5px 10px; border-radius: 5px;';
          if (result.number === 0) numberSpan.style.background = 'linear-gradient(45deg, #EF4444, #8B5CF6)';
          else if ([1,3,7,9].includes(result.number)) numberSpan.style.background = 'linear-gradient(135deg, #10B981, #059669)';
          else if (result.number === 5) numberSpan.style.background = 'linear-gradient(45deg, #10B981, #8B5CF6)';
          else numberSpan.style.background = 'linear-gradient(135deg, #EF4444, #DC2626)';
          numberSpan.style.color = 'white'; numberSpan.textContent = result.number;
          numberCell.appendChild(numberSpan);
          numberCell.style.padding = '12px 8px'; numberCell.style.textAlign = 'center'; numberCell.style.borderBottom = '1px solid #333';
          
          const sizeCell = document.createElement('td');
          sizeCell.textContent = (result.size || 'small').toUpperCase();
          sizeCell.style.padding = '12px 8px'; sizeCell.style.textAlign = 'center'; sizeCell.style.borderBottom = '1px solid #333';
          sizeCell.style.color = result.size === 'big' ? '#F59E0B' : '#3B82F6';
          
          const colorCell = document.createElement('td');
          colorCell.style.fontSize = '1.5rem'; colorCell.style.padding = '12px 8px'; colorCell.style.textAlign = 'center'; colorCell.style.borderBottom = '1px solid #333';
          const colors = result.colors || ['red'];
          const colorEmojis = colors.map(c => { if (c === 'red') return 'üî¥'; if (c === 'green') return 'üü¢'; if (c === 'violet') return 'üü£'; return ''; }).join(' ');
          colorCell.textContent = colorEmojis;
          
          row.appendChild(periodCell); row.appendChild(numberCell); row.appendChild(sizeCell); row.appendChild(colorCell);
          tbody.appendChild(row);
        });
      }
      const totalPages = Math.ceil(allResults.length / RESULTS_PER_PAGE) || 1;
      document.getElementById('currentPageNum').textContent = pageNum;
      document.getElementById('totalPagesNum').textContent = totalPages;
      document.getElementById('prevPageBtn').disabled = (pageNum === 1);
      document.getElementById('nextPageBtn').disabled = (pageNum >= totalPages);
    }

    function previousPage() { if (currentPage > 1) { currentPage--; displayResultsForPage(currentPage); } }
    function nextPage() { const totalPages = Math.ceil(allResults.length / RESULTS_PER_PAGE); if (currentPage < totalPages) { currentPage++; displayResultsForPage(currentPage); } }

    function showGameHistory() {
      document.querySelectorAll('.history-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.history-tab')[0].classList.add('active');
      currentPage = 1; displayResultsForPage(currentPage);
    }

    function showMyHistory() {
      if (!currentUser) { showToast("Please login to view your bet history"); return; }
      database.ref('user_bets/' + currentUser.userId).once('value').then(snapshot => {
        const bets = snapshot.val();
        if (!bets) { showToast("No bet history found"); return; }
        document.querySelectorAll('.history-tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.history-tab')[1].classList.add('active');
        const tbody = document.getElementById('historyTableBody');
        if (!tbody) return;
        tbody.innerHTML = '';
        Object.entries(bets).sort((a, b) => b[1].timestamp - a[1].timestamp).slice(0, 20).forEach(([roundId, bet]) => {
          const row = document.createElement('tr');
          const roundCell = document.createElement('td');
          roundCell.textContent = roundId.slice(-4); roundCell.style.padding = '12px 8px'; roundCell.style.textAlign = 'center'; roundCell.style.borderBottom = '1px solid #333'; roundCell.style.color = 'white';
          
          const betCell = document.createElement('td');
          betCell.textContent = typeof bet.selection === 'number' ? `${bet.selection}` : bet.selection.toUpperCase();
          betCell.style.padding = '12px 8px'; betCell.style.textAlign = 'center'; betCell.style.borderBottom = '1px solid #333'; betCell.style.color = 'white';
          
          const amountCell = document.createElement('td');
          amountCell.textContent = `‚Çπ${bet.amount}`; amountCell.style.padding = '12px 8px'; amountCell.style.textAlign = 'center'; amountCell.style.borderBottom = '1px solid #333'; amountCell.style.color = 'white';
          
          const statusCell = document.createElement('td');
          statusCell.textContent = bet.status === 'won' ? '‚úÖ' : bet.status === 'lost' ? '‚ùå' : '‚è≥';
          statusCell.style.padding = '12px 8px'; statusCell.style.textAlign = 'center'; statusCell.style.borderBottom = '1px solid #333'; statusCell.style.fontSize = '1.5rem';
          
          row.appendChild(roundCell); row.appendChild(betCell); row.appendChild(amountCell); row.appendChild(statusCell);
          tbody.appendChild(row);
        });
      });
    }

    function refreshWingoBalance() {
      if (!currentUser) return;
      const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
      database.ref('users/' + cleanPhone + '/balance').once('value').then(snapshot => {
        const balance = snapshot.val();
        if (balance !== null) {
          currentUser.balance = balance;
          localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
          updateUserInfo();
          showToast("‚úÖ Balance refreshed!");
        }
      });
    }

    function refreshWalletBalance() { refreshWingoBalance(); }
    function showNotifications() { showToast("No new notifications"); }

    function goBackToHome() {
      clearInterval(countdownInterval);
      clearInterval(betLockTimer);
      if (pendingResultCheck) { clearInterval(pendingResultCheck); pendingResultCheck = null; }
      isWingoPageActive = false;
      document.getElementById('bottomNav').classList.remove('hide-nav');
      switchTab('home');
    }

    function showDepositPage() {
      isWingoPageActive = false;
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('wingoPage').style.display = 'none';
      document.getElementById('depositPage').style.display = 'block';
      document.getElementById('page-title').textContent = 'Deposit';
      initializeDepositPage();
    }

    function goBackFromDeposit() {
      if (document.getElementById('wingoPage').style.display === 'block') {
        document.getElementById('depositPage').style.display = 'none';
        document.getElementById('wingoPage').style.display = 'block';
        isWingoPageActive = true;
      } else { switchTab('wallet'); }
    }

    function showWithdrawalPage() {
      isWingoPageActive = false;
      document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
      document.getElementById('wingoPage').style.display = 'none';
      document.getElementById('withdrawalPage').style.display = 'block';
      document.getElementById('page-title').textContent = 'Withdraw';
    }

    function goBackFromWithdrawal() {
      if (document.getElementById('wingoPage').style.display === 'block') {
        document.getElementById('withdrawalPage').style.display = 'none';
        document.getElementById('wingoPage').style.display = 'block';
        isWingoPageActive = true;
      } else { switchTab('wallet'); }
    }

    function checkPendingBets() {
      if (!currentUser) return;
      database.ref('user_bets/' + currentUser.userId).once('value').then(snapshot => {
        const userBets = snapshot.val();
        if (!userBets) return;
        Object.entries(userBets).forEach(([roundId, betData]) => {
          if (betData.status === 'pending') {
            database.ref('results/' + roundId).once('value').then(resultSnapshot => {
              if (resultSnapshot.exists()) {
                const result = resultSnapshot.val();
                processBetResult(betData, result, roundId);
              }
            });
          }
        });
      });
    }

    function checkUserBetsForRound(roundId, result) {
      if (!currentUser) return;
      database.ref('user_bets/' + currentUser.userId + '/' + roundId).once('value').then(snapshot => {
        if (snapshot.exists()) {
          const betData = snapshot.val();
          if (betData.status === 'pending') {
            processBetResult(betData, result, roundId);
          }
        }
      });
    }

    function loadMyBets() {
      if (!currentUser) return;
      const container = document.getElementById('myBetsContainer');
      container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">Loading your bets...</div>';
      database.ref('user_bets/' + currentUser.userId).once('value').then(snapshot => {
        const bets = snapshot.val();
        if (!bets) { container.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">No bets yet</div>'; return; }
        container.innerHTML = '';
        const betArray = Object.entries(bets);
        betArray.sort((a, b) => b[1].timestamp - a[1].timestamp).forEach(([roundId, bet]) => {
          const betDiv = document.createElement('div');
          betDiv.style = 'background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid ' + (bet.status === 'won' ? '#10B981' : bet.status === 'lost' ? '#EF4444' : '#F59E0B') + ';';
          const selectionText = typeof bet.selection === 'number' ? `Number ${bet.selection}` : bet.selection.toUpperCase();
          const statusText = bet.status === 'won' ? 'WON' : bet.status === 'lost' ? 'LOST' : 'PENDING';
          const statusColor = bet.status === 'won' ? '#10B981' : bet.status === 'lost' ? '#EF4444' : '#F59E0B';
          betDiv.innerHTML = `
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><div style="font-weight: bold; color: var(--gold);">Round: ${roundId.slice(-4)}</div><div style="font-weight: bold; color: ${statusColor};">${statusText}</div></div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><div style="color: white;">${selectionText}</div><div style="color: white;">‚Çπ${bet.amount}</div></div>
            <div style="font-size: 12px; color: var(--text-gray);">${new Date(bet.timestamp).toLocaleString()}</div>
            ${bet.status === 'won' ? `<div style="color: #10B981; font-weight: bold; margin-top: 5px;">Won: ‚Çπ${(bet.amount * (typeof bet.selection === 'number' ? 9.0 : bet.selection === 'violet' ? 4.0 : 1.98)).toFixed(2)}</div>` : ''}
          `;
          container.appendChild(betDiv);
        });
      });
    }

    function logout() {
      if (confirm("Are you sure you want to logout?")) {
        currentUser = null;
        localStorage.removeItem('glowbet_user');
        document.getElementById("mainApp").classList.add("hidden");
        document.getElementById("loginPage").classList.remove("hidden");
        document.getElementById("registerPage").classList.add("hidden");
        clearInterval(countdownInterval);
        clearInterval(betLockTimer);
        isWingoPageActive = false;
        showToast("Logged out successfully");
      }
    }

    function selectBet(selection) {
      if (isBettingLocked) { showToast("Betting is locked for last 5 seconds!"); return; }
      if (!currentUser) { showToast("Please login to place bets"); return; }
      currentBet = { selection: selection, amount: betAmount, roundId: currentRoundId, timestamp: Date.now(), status: 'pending' };
      const betSelection = document.getElementById('betSelection');
      if (typeof selection === 'number') {
        betSelection.textContent = `Number ${selection}`;
        betSelection.style.color = getColorForNumber(selection).includes('red') ? '#EF4444' : getColorForNumber(selection).includes('green') ? '#10B981' : '#8B5CF6';
      } else {
        betSelection.textContent = selection.toUpperCase();
        if (selection === 'red') betSelection.style.color = '#EF4444';
        else if (selection === 'green') betSelection.style.color = '#10B981';
        else if (selection === 'violet') betSelection.style.color = '#8B5CF6';
        else if (selection === 'big') betSelection.style.color = '#F59E0B';
        else if (selection === 'small') betSelection.style.color = '#3B82F6';
      }
      document.getElementById('betAmount').textContent = betAmount;
      document.getElementById('betAmountDisplay').textContent = `‚Çπ${betAmount}`;
      document.getElementById('betPopup').style.display = 'flex';
    }

    function placeBet() {
      if (!currentUser) { showToast("Please login to place bets"); return; }
      if (currentBet.amount > currentUser.balance) { showInsufficientBalance(); closeBetPopup(); return; }
      
      currentUser.balance -= currentBet.amount;
      const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
      database.ref('users/' + cleanPhone + '/balance').set(currentUser.balance);
      localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
      
      const betData = { ...currentBet, userId: currentUser.userId, phone: currentUser.phone };
      database.ref('user_bets/' + currentUser.userId + '/' + currentBet.roundId).set(betData);
      
      showToast(`‚úÖ Bet placed! ‚Çπ${currentBet.amount} on ${typeof currentBet.selection === 'number' ? 'Number ' + currentBet.selection : currentBet.selection.toUpperCase()}`);
      updateUserInfo();
      closeBetPopup();
    }

    function processBetResult(bet, result, roundId) {
      let won = false;
      let winAmount = 0;

      if (typeof bet.selection === 'number') {
        won = (bet.selection === result.number);
        winAmount = won ? bet.amount * 9.0 : 0;
      } else if (bet.selection === 'red') {
        won = result.colors.includes('red');
        winAmount = won ? bet.amount * 1.98 : 0;
      } else if (bet.selection === 'green') {
        won = result.colors.includes('green');
        winAmount = won ? bet.amount * 1.98 : 0;
      } else if (bet.selection === 'violet') {
        won = result.colors.includes('violet');
        winAmount = won ? bet.amount * 4.0 : 0;
      } else if (bet.selection === 'big') {
        won = (result.size === 'big');
        winAmount = won ? bet.amount * 1.98 : 0;
      } else if (bet.selection === 'small') {
        won = (result.size === 'small');
        winAmount = won ? bet.amount * 1.98 : 0;
      }

      if (won) {
        const cleanPhone = currentUser.phone.replace(/[^0-9]/g, '');
        database.ref('users/' + cleanPhone).once('value').then(snapshot => {
          const userData = snapshot.val();
          const newBalance = (userData.balance || 0) + winAmount;
          database.ref('users/' + cleanPhone + '/balance').set(newBalance).then(() => {
            currentUser.balance = newBalance;
            localStorage.setItem('glowbet_user', JSON.stringify(currentUser));
            database.ref('user_bets/' + currentUser.userId + '/' + roundId + '/status').set('won');
            updateUserInfo();
            showWinPopup(winAmount);
            showToast(`üéâ Congratulations! You won ‚Çπ${winAmount.toFixed(2)}!`);
          });
        });
      } else {
        database.ref('user_bets/' + currentUser.userId + '/' + roundId + '/status').set('lost');
        showLosePopup(bet.amount);
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      checkAutoLogin();
      database.ref('admin_message').on('value', snapshot => {
        const message = snapshot.val();
        if (message && message.text && currentUser) {
          document.getElementById('adminMessageSection').style.display = 'block';
          document.getElementById('adminMessageContent').innerHTML = message.text;
        }
      });
    });
  </script>
</body>
</html>
